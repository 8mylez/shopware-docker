FROM debian:stretch-slim

ENV SHOPWARE_ENV docker

RUN mkdir -p /usr/share/man/man1/ && \
    apt update && apt-get install --no-install-recommends -y \
    openjdk-8-jre-headless \
	ant \
	mariadb-client \
	php7.0-cli \
	php7.0-xml \
	php7.0-zip \
	php7.0-json \
	php7.0-zip \
	php7.0-gmp \
	php7.0-mysql \
	php7.0-sqlite3 \
	php7.0-mbstring \
	php7.0-bcmath \
	php7.0-gd \
	php7.0-curl \
	git \
	sudo \
	gpg \
	gpg-agent \
	curl \
	wget \
	nano \
	unzip && \
	curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer && \
	cd /opt/ && \
	git clone https://github.com/shopwareLabs/sw-cli-tools.git \
    && cd sw-cli-tools \
    && composer install --no-dev \
    && ln -s /opt/sw-cli-tools/bin/sw /usr/local/bin/sw \
    && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \
    && useradd dev \
    && mkdir /home/dev \
    && chown -R dev: /home/dev \
    && curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash - \
    && apt-get install nodejs -y

ENV HOME /home/dev
USER dev

RUN composer global require hirak/prestissimo && composer global require bamarni/symfony-console-autocomplete
RUN echo 'eval "$(symfony-autocomplete)"' >> ~/.bash_profile

WORKDIR /var/www/html
